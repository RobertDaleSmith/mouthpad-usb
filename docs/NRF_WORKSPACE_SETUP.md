# Zephyr Workspace Setup with Custom Project in `/projects`

This guide walks through setting up an nRF Connect SDK (Zephyr) workspace and adding your own application inside a `projects/` folder.

---

## 1. Setup Zephyr Workspace

```bash
# Clone manifest repo
west init -m https://github.com/nrfconnect/sdk-nrf --mr main

# Pull in all modules
west update

# Set up environment variables
west zephyr-export

# Optional: Install Python requirements
pip install -r zephyr/scripts/requirements.txt
```

---

## 2. Directory Structure

```
zephyr_workspace/
├── .west/
├── build/                    # (generated by west)
├── nrf/                      # nRF Connect SDK content
├── zephyr/                   # Zephyr RTOS core
├── modules/                  # Additional modules
├── west.yml
└── projects/                 # <-- Your custom apps go here
    └── mouthpad_usb/
        ├── src/
        │   ├── main.c
        │   ├── usb.c
        │   └── usb.h
        ├── prj.conf
        └── CMakeLists.txt
```

---

## 3. Project Files

### `CMakeLists.txt`

```cmake
cmake_minimum_required(VERSION 3.20.0)
find_package(Zephyr REQUIRED HINTS $ENV{ZEPHYR_BASE})
project(mouthpad_usb)

target_sources(app PRIVATE src/main.c src/usb.c)
```

### `prj.conf`

```ini
CONFIG_MAIN_STACK_SIZE=2048

# USB
CONFIG_USB_DEVICE_STACK=y
CONFIG_USB_DEVICE_PID=0x1234
CONFIG_USB_DEVICE_VID=0xCafe
CONFIG_USB_HID=y
CONFIG_USB_HID_MOUSE=y

# BLE Central (optional)
CONFIG_BT=y
CONFIG_BT_CENTRAL=y
CONFIG_BT_OBSERVER=y
CONFIG_BT_GATT_CLIENT=y
```

---

## 4. Build the Project

From the workspace root:

```bash
west build -b xiao_ble --pristine=always projects/mouthpad_usb
```

If renamed:

```bash
west build -b xiao_ble --pristine=always projects/my_new_app
```

---

## 5. Flash the Project

```bash
west flash --runner jlink --build-dir build
```

---

## 6. Debugging Tips

- If build loops endlessly, it may be a `Kconfig` or `sysbuild` issue.
- Disable sysbuild if needed:

```bash
west build -b xiao_ble --pristine=always --no-sysbuild projects/mouthpad_usb
```

- Use menuconfig to explore or tweak options:

```bash
west build -t menuconfig
```

---

Let me know if you'd like a ready-to-use example workspace template!

